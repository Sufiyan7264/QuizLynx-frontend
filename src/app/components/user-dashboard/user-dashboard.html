<div class="user-dashboard-page min-h-[calc(100vh-80px)] px-4 sm:px-6 lg:px-4 py-6 lg:py-20 pt-24">
  <!-- <div class="flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between mb-8">
    <div>
      <p class="text-xs font-medium uppercase tracking-wide text-indigo-600 dark:text-indigo-300">Welcome back</p>
      <h1 class="text-2xl lg:text-3xl font-semibold text-slate-900 dark:text-slate-50">Your Dashboard</h1>
      <p class="mt-1 text-sm text-slate-600 dark:text-slate-300">Track your streak, resume where you left, and see whatâ€™s recommended next.</p>
    </div>
    <div class="flex items-center gap-2 text-xs text-slate-500 dark:text-slate-300">
      <span class="inline-flex h-2 w-2 rounded-full bg-emerald-500"></span>
      Data synced
    </div>
  </div> -->

  <!-- Stats -->
  <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 lg:grid-cols-4 gap-4 mb-6">
    @for(stat of stats; track stat.title){
      <article class="surface-card hoverable-card flex flex-col gap-2">
        <div class="flex items-center justify-between">
          <p class="text-sm font-semibold text-slate-900 dark:text-slate-50">{{ stat.title }}</p>
          <span class="text-[11px] text-slate-500 dark:text-slate-300">{{ stat.period }}</span>
        </div>
        <div class="flex items-center gap-2">
          <span class="text-2xl font-bold text-slate-900 dark:text-slate-50">{{ stat.value }}</span>
          <span
            class="inline-flex items-center gap-1 text-text rounded-lg px-2 py-1 text-[11px] font-semibold"
            [class.increase]="stat.changeType === 'increase'"
            [class.decrease]="stat.changeType === 'decrease'">
            <i class="filter-icon" [class]="stat.changeType === 'increase' ? 'pi pi-arrow-up' : 'pi pi-arrow-down'"></i>
            {{ stat.change }}%
          </span>
        </div>
      </article>
    }
  </div>

  <div class="grid grid-cols-1 xl:grid-cols-3 lg:grid-cols-3 gap-4">
    <!-- Left column -->
    <div class="flex flex-col gap-4 xl:col-span-2 lg:col-span-2">
      <section class="progress-card gradient-card surface-card">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
          <div class="flex-1">
            <p class="text-xs font-semibold uppercase tracking-wide text-indigo-100/80">Daily streak</p>
            <h2 class="mt-1 text-2xl md:text-3xl font-semibold text-white">{{ progressData.milestone }}</h2>
            <p class="mt-1 text-sm text-indigo-50/90">{{ progressData.message }}</p>
            <p class="mt-1 text-xs text-indigo-50/80">{{ progressData.description }}</p>
          </div>
          <!-- <button
            pButton
            type="button"
            label="Resume last quiz"
            class="!h-10 !rounded-xl !bg-white !text-slate-900 !text-xs !font-semibold hover:!bg-slate-100"
          ></button> -->
        </div>
      </section>

      <section class="surface-card">
        <div class="flex items-center justify-between mb-3">
          <h3 class="text-sm font-semibold text-slate-900 dark:text-slate-50">Quiz history</h3>
          <a href="attempts" class="text-xs font-semibold text-slate-700 hover:text-slate-900 dark:text-slate-200">View all</a>
        </div>
        <div class="overflow-auto">
          <table class="quiz-table min-w-full">
            <thead>
              <tr>
                <th>Subject</th>
                <th>Score</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              @for (quiz of quizHistory; track $index) {
                <tr>
                  <td>{{ quiz.subject }}</td>
                  <td>{{ quiz.score }}</td>
                  <td>
                    <span class="status-chip" [class.completed]="quiz.status === 'Completed'" [class.unattempted]="quiz.status === 'Unattempted'">
                      {{ quiz.status }}
                    </span>
                  </td>
                  <td>
                    <div class="flex items-center gap-2">
                      @if(quiz.actions.refresh){
                        <button pButton type="button" icon="pi pi-refresh" class="ghost-icon-btn" (click)="retake(quiz)"></button>
                      }
                      @if(quiz.actions.warning){
                        <button pButton type="button" icon="pi pi-exclamation-triangle" class="ghost-icon-btn warning"></button>
                      }
                      @if(quiz.actions.folder){
                        <button pButton type="button" icon="pi pi-folder" class="ghost-icon-btn"></button>
                      }
                    </div>
                  </td>
                </tr>

              }
            </tbody>
          </table>
        </div>
      </section>
    </div>

    <!-- Right column -->
    <div class="flex flex-col gap-4">
      <section class="surface-card">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-sm font-semibold text-slate-900 dark:text-slate-50">Performance breakdown</h3>
        </div>
        <app-chart-configuration
          [chartType]="'pie'"
          [data]="performanceChartData"
          [width]="'100%'"
          [height]="'240px'"
          [options]="performanceChartOptions">
        </app-chart-configuration>
      </section>

      <section class="surface-card">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-sm font-semibold text-slate-900 dark:text-slate-50">Recommended next</h3>
          <span class="text-[11px] text-slate-500 dark:text-slate-300">{{ practiceSuggestion.subject }}</span>
        </div>
        <p class="text-sm text-slate-700 dark:text-slate-200 mb-3">{{ practiceSuggestion.message }}</p>
        <button
          pButton
          type="button"
          label="Create custom quiz"
          class="!h-9 !rounded-xl !bg-slate-900 !text-white !text-xs !font-semibold hover:!bg-slate-800 dark:!bg-slate-100 dark:!text-slate-900 dark:hover:!bg-slate-200 w-full"
        ></button>
      </section>
    </div>
  </div>
</div>
